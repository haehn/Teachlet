<html>
  <head>
    <title>Harvard TEACHLET</title>

  </head>

<body style='font-family: sans-serif; font-size: 20pt;'>
 <div><img src='logo.jpg'></div>
 <div style='padding:20px'>Hi TF! This will help you memorize the names of your section students.</div>
 <div><img src='1.png' style='vertical-align:middle'><span>Drag this bookmarklet <a href='' id='bookmarklet' alt='Teachlet' title='Teachlet'><img src='bookmark.png' width=50></a> to your bookmarks!</span></div>
 <div><img src='2.png' style='vertical-align:middle'><span>Login to <a href="https://connections.harvard.edu/" target="_blank">Harvard Connections</a>.</span></div>
 <div><img src='3.png' style='vertical-align:middle'><span>Click on the bookmarklet.</span></div>



<script>

function grab_pics() {

  var liste = "<div>";

  var done =0;

  var input = prompt('Provide a list of students');
  input = input.split('\n').sort();


  for (var name in input) {
    name = input[name].trim();
    var t = name.split(',');
    name = t[1].trim() + " " + t[0].trim();
    console.log(name);
    $.get("https://connections.harvard.edu/search/pageNum/0/resultsPerPage/1?name="+name,function(data){

      parser=new DOMParser();
      xmlDoc=parser.parseFromString(data,"text/html"); 
      liste += '<div class="block">' + ($('#compressedUser tr',xmlDoc).first().html()).replace('td','span') + '</div>';
      done ++;

      if (done === input.length) {

         document.body.innerHTML = liste + '</div>';
         $(".block").css("display", "inline-block");
         $(".block").css("padding", "20px");
         $(".block").css("font-size", "0.8em");
         $("h5").remove();
         $('img').css("display", "block");
      }
    });

  }

}
document.getElementById('bookmarklet').href = 'javascript:(' + grab_pics.toString()+')()';

</script>

</body>
</html>

